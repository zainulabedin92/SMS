!function(t,n,i,a,e){t(document).ready(function(){u.init()});var u={init:function(){this.filter_search(),this.onEvent(),this.count(),this.initRouting()},initRouting:function(){var n=window.location.hash,i=t('.filter-links a[href="'+n+'"]');i&&i.click()},count:function(){var n=t(".list-plugins .plugin-card").length,i=t(".list-plugins .plugin-card.required").length,a=t(".list-plugins .plugin-card.recommended").length,e=t(".list-plugins .plugin-card.can-update").length;function u(n,i){var a=t(".filter-links ."+n+" a");a&&a.find("span").text(i)}u("all",n),u("required",i),u("recommended",a),u("updates",e);var s=t(".thim-core-count-notification");s.each(function(t,n){n.className=n.className.replace(/count-\d+/,"count-"+e)}),e>0?s.find(".plugin-count").text(e):s.remove(),e?t(".filter-links .updates").addClass("active"):t(".filter-links .updates").removeClass("active")},filter_search:function(){var n,i,a=t(".thim-wrapper .plugin-tab"),e=a.find(".filter-links"),u=a.find("#plugin-filter").find(".list-plugins").isotope({filter:function(){var a=t(this),e=!n||a.find(".name").text().match(n),u=!i||a.is(i);return e&&u}});e.on("click","li",function(){e.find("li a").removeClass("current"),t(this).find("a").addClass("current"),i=t(this).data("filter"),u.isotope()});var s=t(".wp-filter-search").keyup(this.debounce(function(){n=new RegExp(s.val(),"gi"),u.isotope()}))},debounce:function(t,n){var i;return function(){i&&clearTimeout(i),i=setTimeout(function(){t(),i=null},n||100)}},onEvent:function(){var n=this;i.success(function(i,e){if(i.success){var u=i.data,s=u.action,o=u.slug,r=u.status,l=t(document).find(".plugin-card.plugin-card-"+o),c=l.find(".plugin-action-buttons .button");c.text(u.text),c.attr("data-action",s),l.removeClass("can-update"),l.attr("data-status",r);var d=u.info;l.find(".data_Version").text(d.Version),n.count(),"update"===e.action&&a.updates.decrementCount("plugin")}else{for(var f=i.data.messages,p="",g=0;g<f.length;g++)p+=(m=f[g],t("<textarea></textarea>").html(m).text()+"\n");alert(p)}var m}),i.error(function(n,i){var a=n.slug;t(document).find(".plugin-card.plugin-card-"+a).find(".plugin-action-buttons .button").text("Failed")}),i.complete(function(n){var i=n.slug,a=t(document).find(".plugin-card.plugin-card-"+i).find(".plugin-action-buttons .button");a.attr("disabled",!1),a.removeClass("updating-message")}),t(document).on("click",".plugin-action-buttons button:not(.updating-message)",function(n){n.preventDefault();var a=t(this),u=a.attr("data-action"),s=0;if(void 0!==a.attr("data-premium")&&(s=a.attr("data-premium")),"update"!==u&&"install"!==u||"1"!==s||e.check_active()){a.addClass("updating-message"),a.attr("disabled",!0);var o=a.parents(".plugin-action-buttons").data("slug");i.push({action:u,slug:o})}})}}}(jQuery,Thim_Plugins,Thim_Plugins_Queue,window.wp,window.Thim_Core);
