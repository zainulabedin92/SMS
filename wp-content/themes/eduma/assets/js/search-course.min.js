!function(e){"use strict";function s(s){var t=s.find(".courses-search-input"),i=s.find(".courses-list-search"),r=t.val(),a=s.find(".fa-search,.fa-times");if(r){if(r.length<1)return;a.addClass("fa-spinner fa-spin"),e.ajax({type:"POST",data:"action=courses_searching&keyword="+r+"&from=search",url:ajaxurl,success:function(s){var t="",r="",o=jQuery.parseJSON(s);o.error||(e.each(o,function(e){0==e?"#"!=this.guid?t+='<li class="search-item ui-menu-item'+this.id+'"><a class="ui-corner-all" href="'+this.guid+'">'+this.title+"</a></li>":t+='<li class="search-item ui-menu-item">'+this.title+"</li>":e==o.length-1&&this.see_more?r=this.see_more:t+='<li class="search-item ui-menu-item'+this.id+'"><a class="ui-corner-all" href="'+this.guid+'">'+this.title+"</a></li>"}),i.addClass("search-visible").html("").append(t),r&&i.append('<li class="see-more">'+r+"</li>")),e(".courses-list-search .search-item").on("mouseenter",function(){e(".courses-list-search .search-item").removeClass("ob-selected"),e(this).addClass("ob-selected")}),e(".courses-list-search .search-item").on("mouseleave",function(){e(".courses-list-search .search-item").removeClass("ob-selected")}),function(){e(".search-item").length>0&&e(".see-more").show();e(".see-more").on("click",function(s){e(".courses-searching form").submit()})}(),a.removeClass("fa-spinner fa-spin")},error:function(e){}})}}e(document).ready(function(){e(document).on("click",".thim-course-search-overlay .search-toggle",function(s){s.stopPropagation();var t=e(this).parent();e("body").addClass("thim-search-active"),setTimeout(function(){t.find(".thim-s").focus()},500)}),e(document).on("click",".search-popup-bg",function(){var s=e(this).parent();window.clearTimeout(!1),s.find(".courses-list-search").empty(),s.find(".thim-s").val(""),e("body").removeClass("thim-search-active")}),e(document).on("keyup",".courses-search-input",function(t){clearTimeout(e.data(this,"search_timer"));var i=e(this).parents(".courses-searching"),r=i.find(".courses-list-search"),a=r.find(">li");if(13==t.which)t.preventDefault(),e(this).stop();else if(38==t.which){if(-1!=navigator.userAgent.indexOf("Chrome")&&parseFloat(navigator.userAgent.substring(navigator.userAgent.indexOf("Chrome")+7).split(" ")[0])>=15){var o=a.filter(".ob-selected");a.length>1&&(a.removeClass("ob-selected"),0==o.prev().length?o.siblings().last().addClass("ob-selected"):o.prev().addClass("ob-selected"))}}else if(40==t.which){if(-1!=navigator.userAgent.indexOf("Chrome")&&parseFloat(navigator.userAgent.substring(navigator.userAgent.indexOf("Chrome")+7).split(" ")[0])>=15)0==(o=a.filter(".ob-selected")).length?(o=a.first()).addClass("ob-selected"):a.length>1&&(a.removeClass("ob-selected"),0==o.next().length?o.siblings().first().addClass("ob-selected"):o.next().addClass("ob-selected"))}else if(27==t.which)e("body").hasClass("thim-search-active")&&e("body").removeClass("thim-search-active"),r.html(""),e(this).val(""),e(this).stop();else{var c=setTimeout(function(){s(i)},500);e(this).data("search_timer",c)}}),e(document).on("keypress",".courses-search-input",function(s){var t=e(this).parents(".courses-searching").find(".courses-list-search>li");if(13==s.keyCode&&(r=t.filter(".ob-selected")).length>0){s.preventDefault();var i=r.find("a").first().attr("href");window.location.href=i}if(27==s.keyCode&&(e("body").hasClass("thim-search-active")&&e("body").removeClass("thim-search-active"),e(".courses-list-search").html(""),e(this).val(""),e(this).stop()),38==s.keyCode){var r=t.filter(".ob-selected");t.length>1&&(t.removeClass("ob-selected"),0==r.prev().length?r.siblings().last().addClass("ob-selected"):r.prev().addClass("ob-selected"))}40==s.keyCode&&(0==(r=t.filter(".ob-selected")).length?(r=t.first()).addClass("ob-selected"):t.length>1&&(t.removeClass("ob-selected"),0==r.next().length?r.siblings().first().addClass("ob-selected"):r.next().addClass("ob-selected")))}),e(document).on("click",".courses-list-search, .courses-search-input",function(e){e.stopPropagation()}),e(document).on("click","body",function(){e("body").hasClass("course-scroll-remove")||(e("body").addClass("course-scroll-remove"),e(".courses-list-search").html(""))}),e(window).scroll(function(){e("body").hasClass("course-scroll-remove")&&e(".courses-list-search li").length>0&&(e(".courses-searching .courses-list-search").empty(),e(".courses-searching .thim-s").val(""))}),e(document).on("focus",".courses-search-input",function(){e("body").hasClass("course-scroll-remove")&&e("body").removeClass("course-scroll-remove")}),e(document).on("click","#popup-header .search-visible",function(s){e(s.target).attr("href")||e("#popup-header .search-visible").removeClass("search-visible")}),e(document).on("click","#popup-header button",function(s){e("#popup-header .thim-s").trigger("focus")}),e(document).on("focus","#popup-header .thim-s",function(){var s=e("#popup-header .courses-list-search a");""!=e(this).val()&&s.length>0&&e("#popup-header .courses-list-search").addClass("search-visible")})})}(jQuery);